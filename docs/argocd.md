# ArgoCD

[Back](../README.md)

- [ArgoCD](#argocd)
  - [ArgoCD](#argocd-1)
  - [Installation](#installation)
    - [Install with Helm](#install-with-helm)
    - [Enable Ingress access](#enable-ingress-access)
  - [CLI](#cli)
    - [Installation](#installation-1)
    - [login](#login)
    - [Update new pwd](#update-new-pwd)

---

## ArgoCD

- `ArgoCD`
  - an open-source, **declarative** `continuous delivery (CD)` tool designed specifically for Kubernetes to automate application deployment using `GitOps` principles.

- Core Architectural Components
  - `API Server`:
    - exposes the API for the Web UI, CLI, and external CI/CD systems.
  - `Repository Server (Repo Server)`
    - An internal service that maintains a **local cache** of the `Git`, `Helm`, or OCI artifact repositories.
    - responsible for **generating the correct Kubernetes manifests** (using tools like Kustomize or Helm) when provided with the repository details and revision.
  - `Application Controller`:
    - A `Kubernetes controller` that continuously **monitors** running applications.
    - It compares the live state of the application in the cluster with the desired state generated by the Repo Server. If a deviation (configuration drift) is detected, it flags the application as OutOfSync and can automatically or manually sync the live state to match the desired state in Git.
  - `CLI`: interface to interact

---

## Installation

### Install with Helm

- ref: https://argoproj.github.io/argo-helm/

```sh
# add repo
helm repo add argo https://argoproj.github.io/argo-helm
# "argo" has been added to your repositories

helm repo ls
# NAME                    URL
# argo                    https://argoproj.github.io/argo-helm

helm repo update
# Hang tight while we grab the latest from your chart repositories...
# ...Successfully got an update from the "argo" chart repository
# Update Complete. ⎈Happy Helming!⎈

# confirm chart in repo
helm search repo argocd
# NAME                            CHART VERSION   APP VERSION     DESCRIPTION
# argo/argo-cd                    3.35.4          v2.2.5          A Helm chart for ArgoCD, a declarative, GitOps ...

# create ns
kubectl create ns argocd
# namespace/argocd created

# install helm chart
helm install argocd -n argocd argo/argo-cd
# NAME: argocd
# LAST DEPLOYED: Fri Feb 20 21:20:58 2026
# NAMESPACE: argocd
# STATUS: deployed
# REVISION: 1
# TEST SUITE: None
# NOTES:
# In order to access the server UI you have the following options:

# 1. kubectl port-forward service/argocd-server -n argocd 8080:443

#     and then open the browser on http://localhost:8080 and accept the certificate

# 2. enable ingress in the values file `server.ingress.enabled` and either
#       - Add the annotation for ssl passthrough: https://argo-cd.readthedocs.io/en/stable/operator-manual/ingress/#option-1-ssl-passthrough
#       - Set the `configs.params."server.insecure"` in the values file and terminate SSL at your ingress: https://argo-cd.readthedocs.io/en/stable/operator-manual/ingress/#option-2-multiple-ingress-objects-and-hosts


# After reaching the UI the first time you can login with username: admin and the random password generated during the installation. You can find the password by running:

# kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d

# (You should delete the initial secret afterwards as suggested by the Getting Started Guide: https://argo-cd.readthedocs.io/en/stable/getting_started/#4-login-using-the-cli)

# confirm
helm list -n argocd
# NAME    NAMESPACE       REVISION        UPDATED                                 STATUS          CHART             APP VERSION
# argocd  argocd          1               2026-02-20 21:20:58.607033566 -0500 EST deployed        argo-cd-9.4.3     v3.3.1

# decode the pwd
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d

# reach ui, using --address 0.0.0.0 to listen the external traffic
kubectl port-forward -n argocd svc/argocd-server 8080:443 --address 0.0.0.0
```

- First login
  - username: admin
  - pwd: decoded pwd

![01](1st_login01.png)
![01](1st_login02.png)

---

### Enable Ingress access

- Ref: https://argo-cd.readthedocs.io/en/stable/operator-manual/ingress/#option-2-ssl-termination-at-ingress-controller

```sh
# setup secret
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout argocd_server.key -out argocd_server.crt -subj "/CN=argocd.server"

kubectl -n argocd create secret tls argocd-server-tls --cert=argocd_server.crt --key=argocd_server.key

# define ingress: SSL Termination
tee argocd-ingress.yaml<<EOF
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: argocd-server-http-ingress
  namespace: argocd
  annotations:
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
    nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
spec:
  ingressClassName: nginx
  rules:
  - host: argocd.server
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: argocd-server
            port:
              name: http
  tls:
  - hosts:
    - argocd.server
    secretName: argocd-server-tls
EOF

kubectl apply -f argocd-ingress.yaml
# ingress.networking.k8s.io/argocd-server-http-ingress created

# confirm
kubectl get ingress -n argocd
# NAME                         CLASS   HOSTS           ADDRESS          PORTS     AGE
# argocd-server-http-ingress   nginx   argocd.server   192.168.10.200   80, 443   57s

# upgrade and set values
helm upgrade argocd -n argocd --set configs.params."server\.insecure"=true argo/argo-cd

# confirm values
helm get values argocd -n argocd
# USER-SUPPLIED VALUES:
# configs:
#   params:
#     server.insecure

```

- Access UI
  - https://argocd.server/

---

## CLI

### Installation

- windows: https://argo-cd.readthedocs.io/en/stable/cli_installation/#windows

```sh
# confirm
argocd version
# argocd: v3.3.1+326a1db
#   BuildDate: 2026-02-18T12:10:04Z
#   GitCommit: 326a1dbd6b9f061207f814049f88e73fd8880c55
#   GitTreeState: clean
#   GoVersion: go1.25.5
#   Compiler: gc
#   Platform: windows/amd64
# {"level":"fatal","msg":"Argo CD server address unspecified","time":"2026-02-20T23:13:47-05:00"}

```

- Linux: https://argo-cd.readthedocs.io/en/stable/cli_installation/#linux-and-wsl

```sh
curl -sSL -o argocd-linux-amd64 https://github.com/argoproj/argo-cd/releases/latest/download/argocd-linux-amd64
sudo install -m 555 argocd-linux-amd64 /usr/local/bin/argocd
rm argocd-linux-

# confirm
argocd version
# argocd: v3.3.1+326a1db
#   BuildDate: 2026-02-18T12:10:04Z
#   GitCommit: 326a1dbd6b9f061207f814049f88e73fd8880c55
#   GitTreeState: clean
#   GoVersion: go1.25.5
#   Compiler: gc
#   Platform: linux/amd64
# {"level":"fatal","msg":"Argo CD server address unspecified","time":"2026-02-21T12:04:27-05:00"}
```

---

### login

```sh
argocd login argocd.server --insecure
# {"level":"warning","msg":"Failed to invoke grpc call. Use flag --grpc-web in grpc calls. To avoid this warning message, use flag --grpc-web.","time":"2026-02-21T12:07:22-05:00"}
# Username: admin
# Password:
# 'admin:login' logged in successfully
# Context 'argocd.server' updated

# confirm
argocd repo list
# TYPE  NAME  REPO  INSECURE  OCI  LFS  CREDS  STATUS  MESSAGE  PROJECT
```

---

### Update new pwd

```sh
argocd account update-password --current-password old_pwd --new-password "new_pwd"
# Password updated
# Context 'argocd.server' updated
```